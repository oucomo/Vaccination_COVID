<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Exploration</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Vaccination_COVID</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/oucomo/Vaccination_COVID">
    <span class="fas fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data Exploration</h1>
<h4 class="date">2020-01-29 (update: 2021-03-17)</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2021-03-17
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>Vaccination_COVID/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges"> <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges" class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20210126code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20210126)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20210126code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20210126)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomoucomoVaccinationCOVIDtreec736b3c864887578a332c83bc6bb1ec76826d427targetblankc736b3ca"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/oucomo/Vaccination_COVID/tree/c736b3c864887578a332c83bc6bb1ec76826d427" target="_blank">c736b3c</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomoucomoVaccinationCOVIDtreec736b3c864887578a332c83bc6bb1ec76826d427targetblankc736b3ca" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/oucomo/Vaccination_COVID/tree/c736b3c864887578a332c83bc6bb1ec76826d427" target="_blank">c736b3c</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.Rhistory

Untracked files:
    Untracked:  figures/diptheria_delay_year.png
    Untracked:  figures/diptheria_delay_year2.png
    Untracked:  figures/diptheria_week_year.png
    Untracked:  figures/diptheria_week_year2.png
    Untracked:  figures/hepatitisb_delay_year.png
    Untracked:  figures/hepatitisb_delay_year2.png
    Untracked:  figures/hepatitisb_month_year.png
    Untracked:  figures/hepatitisb_month_year2.png
    Untracked:  figures/hepatitisb_week_year.png
    Untracked:  figures/hepatitisb_week_year2.png
    Untracked:  figures/measle_delay_year2.png
    Untracked:  figures/polio_delay_year.png
    Untracked:  figures/polio_delay_year2.png
    Untracked:  figures/polio_month_year.png
    Untracked:  figures/polio_month_year2.png
    Untracked:  figures/polio_week_year.png
    Untracked:  figures/polio_week_year2.png
    Untracked:  figures/tuberclulosis_delay_year.png
    Untracked:  figures/tuberclulosis_month_year.png
    Untracked:  figures/tuberclulosis_month_year2.png
    Untracked:  figures/tuberclulosis_week_year.png
    Untracked:  figures/tuberclulosis_week_year2.png
    Untracked:  figures/tuberculosis_delay_year2.png

Unstaged changes:
    Modified:   analysis/02_data_exploration.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/02_data_exploration.Rmd</code>) and HTML (<code>docs/02_data_exploration.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/c736b3c864887578a332c83bc6bb1ec76826d427/analysis/02_data_exploration.Rmd" target="_blank">c736b3c</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-14
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/d823330a671d7e31ed51425f01b2cdbbb27e5888/analysis/02_data_exploration.Rmd" target="_blank">d823330</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-14
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/oucomo/Vaccination_COVID/d823330a671d7e31ed51425f01b2cdbbb27e5888/docs/02_data_exploration.html" target="_blank">d823330</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-14
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/4482a14ae86f97533a684046a89c4f338c4b6eb2/analysis/02_data_exploration.Rmd" target="_blank">4482a14</a>
</td>
<td>
Duc Du Hong
</td>
<td>
2021-03-12
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/oucomo/Vaccination_COVID/4482a14ae86f97533a684046a89c4f338c4b6eb2/docs/02_data_exploration.html" target="_blank">4482a14</a>
</td>
<td>
Duc Du Hong
</td>
<td>
2021-03-12
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/cc794679e03cab555321fc7cf4dbe175f3196778/analysis/02_data_exploration.Rmd" target="_blank">cc79467</a>
</td>
<td>
Duc Du Hong
</td>
<td>
2021-03-12
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/oucomo/Vaccination_COVID/cc794679e03cab555321fc7cf4dbe175f3196778/docs/02_data_exploration.html" target="_blank">cc79467</a>
</td>
<td>
Duc Du Hong
</td>
<td>
2021-03-12
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/c92d4e55c173f6dff0237e74492bdd6c38798474/analysis/02_data_exploration.Rmd" target="_blank">c92d4e5</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-06
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/bf616582bdfd88fde8ed05e8e4b5a25814365d60/analysis/02_data_exploration.Rmd" target="_blank">bf61658</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-06
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/abdc8878d13618cde8062314ef810abfacb094d1/analysis/02_data_exploration.Rmd" target="_blank">abdc887</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-06
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/1babaeaed117d6ff178164351034d23f94a649e4/analysis/02_data_exploration.Rmd" target="_blank">1babaea</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-06
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/364071a3848d3fc5813c5da46cefbc4397b35dcb/analysis/02_data_exploration.Rmd" target="_blank">364071a</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-06
</td>
<td>
Update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/6237e67f476f76a6a8f19b6a3200e99770b02d8d/analysis/02_data_exploration.Rmd" target="_blank">6237e67</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-06
</td>
<td>
Update 01_data_cleaning 02_data_exploration
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/53c02d04daef0d890725c75ada1de1c9a62ee3bc/analysis/02_data_exploration.Rmd" target="_blank">53c02d0</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-03
</td>
<td>
Merge branch ‘master’ of <a href="https://github.com/oucomo/Vaccination_COVID" class="uri">https://github.com/oucomo/Vaccination_COVID</a>
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/30f97ba3d674012050f35619bc895d8ea3a087b9/analysis/02_data_exploration.Rmd" target="_blank">30f97ba</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-03
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/oucomo/Vaccination_COVID/30f97ba3d674012050f35619bc895d8ea3a087b9/docs/02_data_exploration.html" target="_blank">30f97ba</a>
</td>
<td>
Duc Du
</td>
<td>
2021-03-03
</td>
<td>
update
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/074a0a4126e9e21636ec53aae4c9175f198a0216/analysis/02_data_exploration.Rmd" target="_blank">074a0a4</a>
</td>
<td>
lampk
</td>
<td>
2021-02-19
</td>
<td>
correct vacname
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/bbd5fae0cdc6f358e250e465e0f9e9ce6ca14796/analysis/02_data_exploration.Rmd" target="_blank">bbd5fae</a>
</td>
<td>
lampk
</td>
<td>
2021-02-19
</td>
<td>
update vacname
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/7e5ed9a23aaabe1053f719d9ddb1cc31d262d853/analysis/02_data_exploration.Rmd" target="_blank">7e5ed9a</a>
</td>
<td>
Duc Du
</td>
<td>
2021-02-03
</td>
<td>
Update 20210203
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/oucomo/Vaccination_COVID/7e5ed9a23aaabe1053f719d9ddb1cc31d262d853/docs/02_data_exploration.html" target="_blank">7e5ed9a</a>
</td>
<td>
Duc Du
</td>
<td>
2021-02-03
</td>
<td>
Update 20210203
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/e65b7808a251c7c92b23df53e1599eb336638f94/analysis/02_data_exploration.Rmd" target="_blank">e65b780</a>
</td>
<td>
lampk
</td>
<td>
2021-01-31
</td>
<td>
initial description of vaccination
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/oucomo/Vaccination_COVID/e65b7808a251c7c92b23df53e1599eb336638f94/docs/02_data_exploration.html" target="_blank">e65b780</a>
</td>
<td>
lampk
</td>
<td>
2021-01-31
</td>
<td>
initial description of vaccination
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/7faa37795ea44f4aa001b04866ddcec5e81106ad/analysis/02_data_exploration.Rmd" target="_blank">7faa377</a>
</td>
<td>
lampk
</td>
<td>
2021-01-31
</td>
<td>
put codes for importing &amp; merging data into a separate R script
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/6096f70cfb3cc5d840ef1365c8ec53a523b7a1ab/analysis/02_data_exploration.Rmd" target="_blank">6096f70</a>
</td>
<td>
lampk
</td>
<td>
2021-01-29
</td>
<td>
resolve conflict
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/9e4de01337870cf10ce7d67095a6bb32b37a21ff/analysis/02_data_exploration.Rmd" target="_blank">9e4de01</a>
</td>
<td>
lampk
</td>
<td>
2021-01-29
</td>
<td>
P0406
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/oucomo/Vaccination_COVID/blob/8d452b38d4e1ae3710d9c63f88d46d2ebb4e5aef/analysis/02_data_exploration.Rmd" target="_blank">8d452b3</a>
</td>
<td>
lampk
</td>
<td>
2021-01-29
</td>
<td>
update merge data
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<pre class="r"><code>knitr::opts_chunk$set()

library(data.table)
library(tidyverse)</code></pre>
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>v ggplot2 3.3.3     v purrr   0.3.4
v tibble  3.0.5     v dplyr   1.0.3
v tidyr   1.1.2     v stringr 1.4.0
v readr   1.4.0     v forcats 0.5.1</code></pre>
<pre><code>-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::between()   masks data.table::between()
x dplyr::filter()    masks stats::filter()
x dplyr::first()     masks data.table::first()
x dplyr::lag()       masks stats::lag()
x dplyr::last()      masks data.table::last()
x purrr::transpose() masks data.table::transpose()</code></pre>
<pre class="r"><code>library(lubridate)</code></pre>
<pre><code>
Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:data.table&#39;:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    date, intersect, setdiff, union</code></pre>
<pre class="r"><code>library(ggplot2)
library(gt)
library(gtsummary)</code></pre>
<div id="quick-look-at-babies" class="section level2">
<h2>Quick look at babies</h2>
<pre class="r"><code>#child &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;child.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)

#child &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;child.rds&quot;))

#child$year &lt;- year(child$dob)
#child$month &lt;- month(child$dob)
#child$week &lt;- week(child$dob)

#child_overall &lt;- child[, .N, by = .(year, month)]
#child_overall2 &lt;- child[, .N, by = .(year, month, week)]
#child_province &lt;- child[, .N, by = .(year, month, province)]
#child_province2 &lt;- child[, .N, by = .(year, month, week, province)]
#child_sex &lt;- child[, .N, by = .(year, month, sex)]
#child_sex2 &lt;- child[, .N, by = .(year, month, week, sex)]
#child_province_sex &lt;- child[, .N, by = .(year, month, province, sex)]
#child_province_sex2 &lt;- child[, .N, by = .(year, month, week, province, sex)]
 
#save(child_overall, child_overall2, child_province, child_province2, child_sex, child_sex2, child_province_sex, child_province_sex2, file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;child.Rdata&quot;))

#tab_child_sum &lt;- tbl_summary(child[year &gt;= 2017 &amp; year &lt;= 2020, .(province, sex, factor(year))])

#save(tab_child_sum, file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;tab_child.Rdata&quot;))</code></pre>
</div>
<div id="quick-look-at-vaccine-shots" class="section level2">
<h2>Quick look at vaccine shots</h2>
<pre class="r"><code>#memory.limit(size=60000)

#vaccine_vad &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;vaccine_vad.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)

#vaccine_vad &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;vaccine_vad.rds&quot;))
#vaccine_vad$vacweek &lt;- week(vaccine_vad$vacdate)

#vaccine_overall &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth)]
#vaccine_overall2 &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, vacweek)]
#vaccine_province &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, province)]
#vaccine_province2 &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, vacweek, province)]
#vaccine_vacname &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, vacname2)]
#vaccine_vacname2 &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, vacweek, vacname2)]
#vaccine_province_vacname &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, province, vacname2)]
#vaccine_province_vacname2 &lt;- vaccine_vad[, .N, by = .(vacyear, vacmonth, vacweek, province, vacname2)]
#save(vaccine_overall, vaccine_overall2, vaccine_province, vaccine_province2, vaccine_vacname, vaccine_vacname2, vaccine_province_vacname, vaccine_province_vacname2, file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;vaccine.Rdata&quot;))
 
#tab_vac_sum &lt;- tbl_summary(vaccine_vad[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020, .(province, vacname2, factor(vacyear))])
#save(tab_vac_sum, file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;tab_vaccine.Rdata&quot;))</code></pre>
<pre class="r"><code>load(file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;vaccine.Rdata&quot;))
load(file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;tab_vaccine.Rdata&quot;))

load(file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;child.Rdata&quot;))
load(file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;tab_child.Rdata&quot;))

error_datetime &lt;- read.csv(file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;error_datetime.csv&quot;))
error_duplicate &lt;- read.csv(file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;error_duplicate.csv&quot;))</code></pre>
<div id="descriptive-table" class="section level3">
<h3>Descriptive table</h3>
<pre class="r"><code>tab_vac_sum</code></pre>
<pre><code>Warning: The `.dots` argument of `group_by()` is deprecated as of dplyr 1.0.0.
This warning is displayed once every 8 hours.
Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pphsnnkypr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pphsnnkypr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pphsnnkypr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pphsnnkypr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pphsnnkypr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphsnnkypr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pphsnnkypr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pphsnnkypr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pphsnnkypr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pphsnnkypr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pphsnnkypr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pphsnnkypr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pphsnnkypr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pphsnnkypr .gt_from_md > :first-child {
  margin-top: 0;
}

#pphsnnkypr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pphsnnkypr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pphsnnkypr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pphsnnkypr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphsnnkypr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pphsnnkypr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pphsnnkypr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pphsnnkypr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pphsnnkypr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pphsnnkypr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pphsnnkypr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pphsnnkypr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pphsnnkypr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pphsnnkypr .gt_left {
  text-align: left;
}

#pphsnnkypr .gt_center {
  text-align: center;
}

#pphsnnkypr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pphsnnkypr .gt_font_normal {
  font-weight: normal;
}

#pphsnnkypr .gt_font_bold {
  font-weight: bold;
}

#pphsnnkypr .gt_font_italic {
  font-style: italic;
}

#pphsnnkypr .gt_super {
  font-size: 65%;
}

#pphsnnkypr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="pphsnnkypr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N = 29,993,105</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">province</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Giang</td>
      <td class="gt_row gt_center">1,591,808 (5.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Kan</td>
      <td class="gt_row gt_center">244,880 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Ninh</td>
      <td class="gt_row gt_center">927,027 (3.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Cao Bang</td>
      <td class="gt_row gt_center">379,215 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Dien Bien</td>
      <td class="gt_row gt_center">574,971 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Giang</td>
      <td class="gt_row gt_center">732,869 (2.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Nam</td>
      <td class="gt_row gt_center">617,162 (2.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Noi</td>
      <td class="gt_row gt_center">3,832,491 (13%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Tinh</td>
      <td class="gt_row gt_center">1,030,034 (3.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Duong</td>
      <td class="gt_row gt_center">1,184,588 (3.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Phong</td>
      <td class="gt_row gt_center">1,143,048 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hoa Binh</td>
      <td class="gt_row gt_center">608,148 (2.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hung Yen</td>
      <td class="gt_row gt_center">816,231 (2.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lai Chau</td>
      <td class="gt_row gt_center">430,268 (1.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lang Son</td>
      <td class="gt_row gt_center">607,244 (2.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lao Cai</td>
      <td class="gt_row gt_center">604,380 (2.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nam Dinh</td>
      <td class="gt_row gt_center">1,342,473 (4.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nghe An</td>
      <td class="gt_row gt_center">2,522,912 (8.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ninh Binh</td>
      <td class="gt_row gt_center">789,776 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Phu Tho</td>
      <td class="gt_row gt_center">1,005,937 (3.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Quang Ninh</td>
      <td class="gt_row gt_center">826,492 (2.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Son La</td>
      <td class="gt_row gt_center">1,105,531 (3.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Binh</td>
      <td class="gt_row gt_center">1,186,984 (4.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Nguyen</td>
      <td class="gt_row gt_center">917,404 (3.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thanh Hoa</td>
      <td class="gt_row gt_center">2,791,699 (9.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Tuyen Quang</td>
      <td class="gt_row gt_center">597,191 (2.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Vinh Phuc</td>
      <td class="gt_row gt_center">910,584 (3.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Yen Bai</td>
      <td class="gt_row gt_center">671,758 (2.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">vacname2</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">BCG</td>
      <td class="gt_row gt_center">3,214,600 (11%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">DPT</td>
      <td class="gt_row gt_center">1,137,891 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">DPT_HepB_Hib</td>
      <td class="gt_row gt_center">6,545,043 (22%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">HepBN</td>
      <td class="gt_row gt_center">2,474,179 (8.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">IPV</td>
      <td class="gt_row gt_center">1,161,812 (3.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">JEV</td>
      <td class="gt_row gt_center">5,083,563 (17%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Measle</td>
      <td class="gt_row gt_center">2,182,006 (7.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Measle_Rubella</td>
      <td class="gt_row gt_center">1,651,176 (5.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">OPV</td>
      <td class="gt_row gt_center">6,541,255 (22%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Td</td>
      <td class="gt_row gt_center">243 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Tetanus</td>
      <td class="gt_row gt_center">1,337 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">V3</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2017</td>
      <td class="gt_row gt_center">4,336,085 (14%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2018</td>
      <td class="gt_row gt_center">8,101,547 (27%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2019</td>
      <td class="gt_row gt_center">8,945,653 (30%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2020</td>
      <td class="gt_row gt_center">8,609,820 (29%)</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="2">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          n (%)
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
<pre class="r"><code>tab_child_sum</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qismozzsxu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qismozzsxu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qismozzsxu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qismozzsxu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qismozzsxu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qismozzsxu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qismozzsxu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qismozzsxu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qismozzsxu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qismozzsxu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qismozzsxu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qismozzsxu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qismozzsxu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qismozzsxu .gt_from_md > :first-child {
  margin-top: 0;
}

#qismozzsxu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qismozzsxu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qismozzsxu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qismozzsxu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qismozzsxu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qismozzsxu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qismozzsxu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qismozzsxu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qismozzsxu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qismozzsxu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qismozzsxu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qismozzsxu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qismozzsxu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qismozzsxu .gt_left {
  text-align: left;
}

#qismozzsxu .gt_center {
  text-align: center;
}

#qismozzsxu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qismozzsxu .gt_font_normal {
  font-weight: normal;
}

#qismozzsxu .gt_font_bold {
  font-weight: bold;
}

#qismozzsxu .gt_font_italic {
  font-style: italic;
}

#qismozzsxu .gt_super {
  font-size: 65%;
}

#qismozzsxu .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="qismozzsxu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>N = 3,527,319</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">province</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Giang</td>
      <td class="gt_row gt_center">177,703 (5.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Kan</td>
      <td class="gt_row gt_center">23,206 (0.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Ninh</td>
      <td class="gt_row gt_center">103,927 (2.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Cao Bang</td>
      <td class="gt_row gt_center">38,608 (1.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Dien Bien</td>
      <td class="gt_row gt_center">56,592 (1.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Giang</td>
      <td class="gt_row gt_center">80,226 (2.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Nam</td>
      <td class="gt_row gt_center">67,132 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Noi</td>
      <td class="gt_row gt_center">599,603 (17%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Tinh</td>
      <td class="gt_row gt_center">118,065 (3.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Duong</td>
      <td class="gt_row gt_center">145,810 (4.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Phong</td>
      <td class="gt_row gt_center">162,867 (4.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hoa Binh</td>
      <td class="gt_row gt_center">66,244 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hung Yen</td>
      <td class="gt_row gt_center">97,996 (2.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lai Chau</td>
      <td class="gt_row gt_center">43,036 (1.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lang Son</td>
      <td class="gt_row gt_center">61,396 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lao Cai</td>
      <td class="gt_row gt_center">68,034 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nam Dinh</td>
      <td class="gt_row gt_center">147,049 (4.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nghe An</td>
      <td class="gt_row gt_center">315,546 (8.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ninh Binh</td>
      <td class="gt_row gt_center">88,278 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Phu Tho</td>
      <td class="gt_row gt_center">102,530 (2.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Quang Ninh</td>
      <td class="gt_row gt_center">96,240 (2.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Son La</td>
      <td class="gt_row gt_center">100,688 (2.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Binh</td>
      <td class="gt_row gt_center">134,790 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Nguyen</td>
      <td class="gt_row gt_center">96,256 (2.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thanh Hoa</td>
      <td class="gt_row gt_center">305,264 (8.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Tuyen Quang</td>
      <td class="gt_row gt_center">67,011 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Vinh Phuc</td>
      <td class="gt_row gt_center">97,303 (2.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Yen Bai</td>
      <td class="gt_row gt_center">65,919 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sex</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0</td>
      <td class="gt_row gt_center">1,851,797 (52%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">1</td>
      <td class="gt_row gt_center">1,675,344 (47%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2</td>
      <td class="gt_row gt_center">178 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">V3</td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2017</td>
      <td class="gt_row gt_center">923,941 (26%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2018</td>
      <td class="gt_row gt_center">881,926 (25%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2019</td>
      <td class="gt_row gt_center">915,119 (26%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2020</td>
      <td class="gt_row gt_center">806,333 (23%)</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="2">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          n (%)
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
</div>
<div id="overall" class="section level3">
<h3>Overall</h3>
<pre class="r"><code>ggplot(data = child_overall[year &gt;= 2017 &amp; year &lt;= 2020], aes(x = factor(month), y = N/1000, color = factor(year))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey90&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = year), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of babies born (x 10^3)&quot;, breaks = seq(from = 50, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of babies born by month and year&quot;)</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;..&quot;, &quot;figures&quot;, &quot;vaccine_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(child_overall[year &gt;= 2017 &amp; year &lt;= 2020], aes(month, N/1000, color = factor(year))) +
  geom_point(size=3) +
  geom_line(aes(group=year)) +
  geom_smooth () +
  facet_wrap(~ year) + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of babies born (x 10^3)&quot;, breaks = seq(from = 50, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of babies born by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;child_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = child_overall2[year &gt;= 2017 &amp; year &lt;= 2020], aes(x = factor(week), y = N/1000, color = factor(year))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey90&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = year), size = 1.5) +
  stat_smooth(method=&quot;loess&quot;, colour=&quot;blue&quot;, size=1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of babies born (x 10^3)&quot;, breaks = seq(from = 0, to = 25, by = 5)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of babies born by week and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;child_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(child_overall2[year &gt;= 2017 &amp; year &lt;= 2020], aes(week, N/1000, color = factor(year))) +
  geom_point(size=3) +
  geom_line(aes(group=year)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of babies born (x 10^3)&quot;, breaks = seq(from = 0, to = 25, by = 5)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of babies born by week and year&quot;) +
  facet_wrap(~ year)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;child_week_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = vaccine_overall[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 50, to = 1100, by = 100)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of vaccination shot by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(vaccine_overall[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacmonth, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 50, to = 1100, by = 200)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of vaccination shot by month and year&quot;) +
  facet_wrap(~ vacyear)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = vaccine_overall2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacweek), y = N/1000, color = factor(vacyear))) +
  #geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 50, to = 1100, by = 100)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of vaccination shot by week and year&quot;)</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(vaccine_overall2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacweek, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 250, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of vaccination shot by week and year&quot;) +
  facet_wrap(~ vacyear)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_week_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="by-province" class="section level3">
<h3>By province</h3>
<pre class="r"><code>ggplot(data = child_province[year &gt;= 2017 &amp; year &lt;= 2020], aes(x = factor(month), y = N/1000, color = factor(year))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey90&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point() +
  geom_line(aes(group = year)) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of babies born (x 10^3)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  facet_wrap(~ province, scale = &quot;free_y&quot;) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;) +
  ggtitle(&quot;Number of vaccination babies born in each province by month and year&quot;)</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;child_province_year.png&quot;), width = 10, height = 7)</code></pre>
<pre class="r"><code>ggplot(data = vaccine_province[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point() +
  geom_line(aes(group = vacyear)) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  facet_wrap(~ province, scale = &quot;free_y&quot;) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;) +
  ggtitle(&quot;Number of vaccination shot in each province by month and year&quot;)</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_province_year.png&quot;), width = 10, height = 7)</code></pre>
</div>
<div id="by-vaccine" class="section level3">
<h3>By vaccine</h3>
<pre class="r"><code>ggplot(data = vaccine_vacname[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000)) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(aes(color = factor(vacyear))) +
  geom_line(aes(group = vacyear, color = factor(vacyear))) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  facet_wrap(~ vacname2, scale = &quot;free_y&quot;) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;) +
  ggtitle(&quot;Number of shot of each vaccine by month and year&quot;)</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_month_year_vaccine.png&quot;), width = 10, height = 7)</code></pre>
</div>
<div id="in-cao-bang-ha-noi-and-nghe-an-by-vaccine" class="section level3">
<h3>In Cao Bang, Ha Noi and Nghe An by vaccine</h3>
<pre class="r"><code>ggplot(data = vaccine_province_vacname[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020 &amp; province %in% c(&quot;Cao Bang&quot;, &quot;Ha Noi&quot;, &quot;Nghe An&quot;)], aes(x = factor(vacmonth), y = N)) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(aes(color = factor(vacname2))) +
  geom_line(aes(group = vacname2, color = factor(vacname2))) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot&quot;) +
  scale_color_discrete(name = &quot;Name of vaccine&quot;) +
  facet_grid(province ~ vacyear, scale = &quot;free_y&quot;) +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;) +
  ggtitle(&quot;Number of shot of each vaccine by province and time&quot;)</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;vaccine_month_year_vaccine_CB_HN_NA.png&quot;), width = 10, height = 7)</code></pre>
</div>
<div id="measle" class="section level3">
<h3>Measle</h3>
<pre class="r"><code>measle &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;measle.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)
measle$vacweek &lt;- week(measle$vacdate)

mea &lt;- measle[, .N, by = .(vacyear, vacmonth)]
mea2 &lt;- measle[, .N, by = .(vacyear, vacmonth, vacweek)]
mea_delay &lt;- measle[, .N, by = .(vacyear, vacmonth, vacdelay, vacname2)]</code></pre>
<div id="overall-1" class="section level4">
<h4>Overall</h4>
<pre class="r"><code>ggplot(data = mea[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 200, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Measle vaccination shot by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;measle_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(mea[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacmonth, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 200, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Measle vaccination shot by month and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;measle_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = mea2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacweek), y = N/1000, color = factor(vacyear))) +
  #geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 60, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Measle vaccination shot by week and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;measle_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(mea2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacweek, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 60, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of vaccination shot by week and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;measle_week_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="delays-in-vaccination-months" class="section level4">
<h4>Delays in vaccination (months)</h4>
<pre class="r"><code>library(ggridges)</code></pre>
<pre><code>Warning: package &#39;ggridges&#39; was built under R version 4.0.4</code></pre>
<pre class="r"><code>ggplot(data = measle[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = vacdelay, y = factor(vacmonth), color = factor(vacyear))) +
  geom_density_ridges() +
  theme_ridges() + 
  theme(legend.position = &quot;none&quot;) +
  facet_grid(vacname2~ vacyear, scale = &quot;free_y&quot;) +
  labs(y = &quot;Months in year&quot;, x=&quot;Duration of delays in Measle vaccination (months)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  ggtitle(&quot;Delays in Measle vaccination (months) by month and year&quot;)</code></pre>
<pre><code>Picking joint bandwidth of 1.26</code></pre>
<pre><code>Picking joint bandwidth of 0.0775</code></pre>
<pre><code>Picking joint bandwidth of 0.0762</code></pre>
<pre><code>Picking joint bandwidth of 0.0894</code></pre>
<pre><code>Picking joint bandwidth of 3.58</code></pre>
<pre><code>Picking joint bandwidth of 0.565</code></pre>
<pre><code>Picking joint bandwidth of 0.0971</code></pre>
<pre><code>Picking joint bandwidth of 0.0931</code></pre>
<pre><code>Warning: Removed 229706 rows containing non-finite values (stat_density_ridges).</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;measle_delay_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="check-date-of-measle-vaccination-before-schedule" class="section level4">
<h4>Check Date of Measle vaccination before schedule</h4>
<pre class="r"><code>measle_check1 &lt;- measle[vacdelay &lt; 0 &amp; vacname2==&quot;Measle&quot;]
measle_check1$type &lt;- &quot;Date of Measle vaccination before schedule (9th month)&quot;
nrow(measle_check1)</code></pre>
<pre><code>[1] 28647</code></pre>
<pre class="r"><code>nrow(measle)</code></pre>
<pre><code>[1] 3814265</code></pre>
<pre class="r"><code>range(measle_check1$vacdate)</code></pre>
<pre><code>[1] &quot;2017-01-10&quot; &quot;2020-12-30&quot;</code></pre>
<pre class="r"><code>table(measle_check1$province)</code></pre>
<pre><code>
  Bac Giang     Bac Kan    Bac Ninh    Cao Bang   Dien Bien    Ha Giang 
        792          56         532         525        1344        2078 
     Ha Nam      Ha Noi     Ha Tinh   Hai Duong   Hai Phong    Hoa Binh 
        477        1686         970        1705         744         391 
   Hung Yen    Lai Chau    Lang Son     Lao Cai    Nam Dinh     Nghe An 
       1165         945         591         740         819        3419 
  Ninh Binh     Phu Tho  Quang Ninh      Son La   Thai Binh Thai Nguyen 
        354         646         838        1632        1160         513 
  Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
       2298         795         493         939 </code></pre>
<pre class="r"><code>head(measle_check1)</code></pre>
<pre><code>               pid province district    commune sex        dob vacname vacname2
1: 101010120170032   Ha Noi  Ba Dinh    Phuc Xa   1 2017-01-18     Soi   Measle
2: 101010120170550   Ha Noi  Ba Dinh    Phuc Xa   0 2017-12-30     Soi   Measle
3: 101010120200085   Ha Noi  Ba Dinh    Phuc Xa   0 2020-04-06     Soi   Measle
4: 101010520170015   Ha Noi  Ba Dinh Quan Thanh   0 2017-02-18     Soi   Measle
5: 101010520170194   Ha Noi  Ba Dinh Quan Thanh   0 2017-08-15     Soi   Measle
6: 101010720170038   Ha Noi  Ba Dinh  Truc Bach   1 2017-01-18     Soi   Measle
   epi tub heb dip per tes hib pol msl rub jev shot start    vacdate vacyear
1:   1   0   0   0   0   0   0   0   1   0   0    1     9 2017-10-05    2017
2:   1   0   0   0   0   0   0   0   1   0   0    1     9 2018-09-05    2018
3:   1   0   0   0   0   0   0   0   1   0   0    1     9 2020-11-11    2020
4:   1   0   0   0   0   0   0   0   1   0   0    1     9 2017-11-05    2017
5:   1   0   0   0   0   0   0   0   1   0   0    1     9 2017-08-15    2017
6:   1   0   0   0   0   0   0   0   1   0   0    1     9 2017-10-05    2017
   vacmonth vacage vacdelay vacweek
1:       10      8       -1      40
2:        9      8       -1      36
3:       11      7       -2      46
4:       11      8       -1      45
5:        8      0       -9      33
6:       10      8       -1      40
                                                     type
1: Date of Measle vaccination before schedule (9th month)
2: Date of Measle vaccination before schedule (9th month)
3: Date of Measle vaccination before schedule (9th month)
4: Date of Measle vaccination before schedule (9th month)
5: Date of Measle vaccination before schedule (9th month)
6: Date of Measle vaccination before schedule (9th month)</code></pre>
<pre class="r"><code>#28647/3814265*100 = 0.75%

measle_check2 &lt;- measle[vacdelay &lt; 0 &amp; vacname2==&quot;Measle_Rubella&quot;]
measle_check2$type &lt;- &quot;Date of Measle-Rubella vaccination before schedule (18th month)&quot;
nrow(measle_check2)</code></pre>
<pre><code>[1] 122229</code></pre>
<pre class="r"><code>nrow(measle)</code></pre>
<pre><code>[1] 3814265</code></pre>
<pre class="r"><code>range(measle_check2$vacdate)</code></pre>
<pre><code>[1] &quot;2017-01-04&quot; &quot;2020-12-30&quot;</code></pre>
<pre class="r"><code>table(measle_check2$province)</code></pre>
<pre><code>
  Bac Giang     Bac Kan    Bac Ninh    Cao Bang   Dien Bien    Ha Giang 
       2303         305       13899        1992        3144        4591 
     Ha Nam      Ha Noi     Ha Tinh   Hai Duong   Hai Phong    Hoa Binh 
        675       29774        2708        1335        3080        1649 
   Hung Yen    Lai Chau    Lang Son     Lao Cai    Nam Dinh     Nghe An 
       4707        2287        3200        1589         760        6217 
  Ninh Binh     Phu Tho  Quang Ninh      Son La   Thai Binh Thai Nguyen 
        445         885        7049       10148        3207        3925 
  Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
       5546        1163        2457        3189 </code></pre>
<pre class="r"><code>head(measle_check2)</code></pre>
<pre><code>               pid province district commune sex        dob vacname
1: 101010120170103   Ha Noi  Ba Dinh Phuc Xa   1 2017-04-25      MR
2: 101010120170152   Ha Noi  Ba Dinh Phuc Xa   0 2017-01-04      MR
3: 101010120170167   Ha Noi  Ba Dinh Phuc Xa   0 2017-05-27      MR
4: 101010120170222   Ha Noi  Ba Dinh Phuc Xa   0 2017-06-22      MR
5: 101010120170241   Ha Noi  Ba Dinh Phuc Xa   0 2017-06-06      MR
6: 101010120170264   Ha Noi  Ba Dinh Phuc Xa   1 2017-07-11      MR
         vacname2 epi tub heb dip per tes hib pol msl rub jev shot start
1: Measle_Rubella   1   0   0   0   0   0   0   0   1   1   0    1    18
2: Measle_Rubella   1   0   0   0   0   0   0   0   1   1   0    1    18
3: Measle_Rubella   1   0   0   0   0   0   0   0   1   1   0    1    18
4: Measle_Rubella   1   0   0   0   0   0   0   0   1   1   0    1    18
5: Measle_Rubella   1   0   0   0   0   0   0   0   1   1   0    1    18
6: Measle_Rubella   1   0   0   0   0   0   0   0   1   1   0    1    18
      vacdate vacyear vacmonth vacage vacdelay vacweek
1: 2018-08-08    2018        8     15       -3      32
2: 2018-05-16    2018        5     16       -2      20
3: 2018-07-11    2018        7     13       -5      28
4: 2018-12-05    2018       12     17       -1      49
5: 2018-12-05    2018       12     17       -1      49
6: 2018-12-03    2018       12     16       -2      49
                                                              type
1: Date of Measle-Rubella vaccination before schedule (18th month)
2: Date of Measle-Rubella vaccination before schedule (18th month)
3: Date of Measle-Rubella vaccination before schedule (18th month)
4: Date of Measle-Rubella vaccination before schedule (18th month)
5: Date of Measle-Rubella vaccination before schedule (18th month)
6: Date of Measle-Rubella vaccination before schedule (18th month)</code></pre>
<pre class="r"><code>#122229/3814265*100 = 3.2%

data_path &lt;- file.path(&quot;..&quot;, &quot;tuann349_vad&quot;)

measle_check &lt;- rbindlist(l = list(measle_check1[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)], 
                            measle_check2[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)]))
#fwrite(x = measle_check, file = file.path(data_path, &quot;check_measle.csv&quot;))</code></pre>
<pre class="r"><code>head(measle_check)</code></pre>
<pre><code>               pid province district    commune sex        dob vacname2
1: 101010120170032   Ha Noi  Ba Dinh    Phuc Xa   1 2017-01-18   Measle
2: 101010120170550   Ha Noi  Ba Dinh    Phuc Xa   0 2017-12-30   Measle
3: 101010120200085   Ha Noi  Ba Dinh    Phuc Xa   0 2020-04-06   Measle
4: 101010520170015   Ha Noi  Ba Dinh Quan Thanh   0 2017-02-18   Measle
5: 101010520170194   Ha Noi  Ba Dinh Quan Thanh   0 2017-08-15   Measle
6: 101010720170038   Ha Noi  Ba Dinh  Truc Bach   1 2017-01-18   Measle
      vacdate vacdelay                                                   type
1: 2017-10-05       -1 Date of Measle vaccination before schedule (9th month)
2: 2018-09-05       -1 Date of Measle vaccination before schedule (9th month)
3: 2020-11-11       -2 Date of Measle vaccination before schedule (9th month)
4: 2017-11-05       -1 Date of Measle vaccination before schedule (9th month)
5: 2017-08-15       -9 Date of Measle vaccination before schedule (9th month)
6: 2017-10-05       -1 Date of Measle vaccination before schedule (9th month)</code></pre>
<pre class="r"><code>measle_check %&gt;% select(-pid, -district, -commune, -type) %&gt;% mutate(vacdelay=factor(vacdelay)) %&gt;% tbl_summary(., by=vacname2)</code></pre>
<pre><code>Column(s) &#39;dob&#39;, and &#39;vacdate&#39; omitted from output.
Accepted classes are &#39;character&#39;, &#39;factor&#39;, &#39;numeric&#39;, &#39;logical&#39;, &#39;integer&#39;, or &#39;difftime&#39;.</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ilanvimtvn .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ilanvimtvn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilanvimtvn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ilanvimtvn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ilanvimtvn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilanvimtvn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilanvimtvn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ilanvimtvn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ilanvimtvn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ilanvimtvn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ilanvimtvn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ilanvimtvn .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ilanvimtvn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ilanvimtvn .gt_from_md > :first-child {
  margin-top: 0;
}

#ilanvimtvn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ilanvimtvn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ilanvimtvn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ilanvimtvn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilanvimtvn .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ilanvimtvn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilanvimtvn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ilanvimtvn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ilanvimtvn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilanvimtvn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilanvimtvn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ilanvimtvn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilanvimtvn .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ilanvimtvn .gt_left {
  text-align: left;
}

#ilanvimtvn .gt_center {
  text-align: center;
}

#ilanvimtvn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ilanvimtvn .gt_font_normal {
  font-weight: normal;
}

#ilanvimtvn .gt_font_bold {
  font-weight: bold;
}

#ilanvimtvn .gt_font_italic {
  font-style: italic;
}

#ilanvimtvn .gt_super {
  font-size: 65%;
}

#ilanvimtvn .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ilanvimtvn" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Measle</strong>, N = 28,647<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Measle_Rubella</strong>, N = 122,229<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">province</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Giang</td>
      <td class="gt_row gt_center">792 (2.8%)</td>
      <td class="gt_row gt_center">2,303 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Kan</td>
      <td class="gt_row gt_center">56 (0.2%)</td>
      <td class="gt_row gt_center">305 (0.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Ninh</td>
      <td class="gt_row gt_center">532 (1.9%)</td>
      <td class="gt_row gt_center">13,899 (11%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Cao Bang</td>
      <td class="gt_row gt_center">525 (1.8%)</td>
      <td class="gt_row gt_center">1,992 (1.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Dien Bien</td>
      <td class="gt_row gt_center">1,344 (4.7%)</td>
      <td class="gt_row gt_center">3,144 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Giang</td>
      <td class="gt_row gt_center">2,078 (7.3%)</td>
      <td class="gt_row gt_center">4,591 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Nam</td>
      <td class="gt_row gt_center">477 (1.7%)</td>
      <td class="gt_row gt_center">675 (0.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Noi</td>
      <td class="gt_row gt_center">1,686 (5.9%)</td>
      <td class="gt_row gt_center">29,774 (24%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Tinh</td>
      <td class="gt_row gt_center">970 (3.4%)</td>
      <td class="gt_row gt_center">2,708 (2.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Duong</td>
      <td class="gt_row gt_center">1,705 (6.0%)</td>
      <td class="gt_row gt_center">1,335 (1.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Phong</td>
      <td class="gt_row gt_center">744 (2.6%)</td>
      <td class="gt_row gt_center">3,080 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hoa Binh</td>
      <td class="gt_row gt_center">391 (1.4%)</td>
      <td class="gt_row gt_center">1,649 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hung Yen</td>
      <td class="gt_row gt_center">1,165 (4.1%)</td>
      <td class="gt_row gt_center">4,707 (3.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lai Chau</td>
      <td class="gt_row gt_center">945 (3.3%)</td>
      <td class="gt_row gt_center">2,287 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lang Son</td>
      <td class="gt_row gt_center">591 (2.1%)</td>
      <td class="gt_row gt_center">3,200 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lao Cai</td>
      <td class="gt_row gt_center">740 (2.6%)</td>
      <td class="gt_row gt_center">1,589 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nam Dinh</td>
      <td class="gt_row gt_center">819 (2.9%)</td>
      <td class="gt_row gt_center">760 (0.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nghe An</td>
      <td class="gt_row gt_center">3,419 (12%)</td>
      <td class="gt_row gt_center">6,217 (5.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ninh Binh</td>
      <td class="gt_row gt_center">354 (1.2%)</td>
      <td class="gt_row gt_center">445 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Phu Tho</td>
      <td class="gt_row gt_center">646 (2.3%)</td>
      <td class="gt_row gt_center">885 (0.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Quang Ninh</td>
      <td class="gt_row gt_center">838 (2.9%)</td>
      <td class="gt_row gt_center">7,049 (5.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Son La</td>
      <td class="gt_row gt_center">1,632 (5.7%)</td>
      <td class="gt_row gt_center">10,148 (8.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Binh</td>
      <td class="gt_row gt_center">1,160 (4.0%)</td>
      <td class="gt_row gt_center">3,207 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Nguyen</td>
      <td class="gt_row gt_center">513 (1.8%)</td>
      <td class="gt_row gt_center">3,925 (3.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thanh Hoa</td>
      <td class="gt_row gt_center">2,298 (8.0%)</td>
      <td class="gt_row gt_center">5,546 (4.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Tuyen Quang</td>
      <td class="gt_row gt_center">795 (2.8%)</td>
      <td class="gt_row gt_center">1,163 (1.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Vinh Phuc</td>
      <td class="gt_row gt_center">493 (1.7%)</td>
      <td class="gt_row gt_center">2,457 (2.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Yen Bai</td>
      <td class="gt_row gt_center">939 (3.3%)</td>
      <td class="gt_row gt_center">3,189 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sex</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0</td>
      <td class="gt_row gt_center">14,799 (52%)</td>
      <td class="gt_row gt_center">64,311 (53%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">1</td>
      <td class="gt_row gt_center">13,848 (48%)</td>
      <td class="gt_row gt_center">57,914 (47%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">vacdelay</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-18</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">309 (0.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-17</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">90 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-16</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">81 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-15</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">81 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-14</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">110 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-13</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">138 (0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-12</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">254 (0.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-11</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">229 (0.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-10</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">236 (0.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-9</td>
      <td class="gt_row gt_center">197 (0.7%)</td>
      <td class="gt_row gt_center">602 (0.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-8</td>
      <td class="gt_row gt_center">88 (0.3%)</td>
      <td class="gt_row gt_center">479 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-7</td>
      <td class="gt_row gt_center">109 (0.4%)</td>
      <td class="gt_row gt_center">568 (0.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-6</td>
      <td class="gt_row gt_center">119 (0.4%)</td>
      <td class="gt_row gt_center">3,624 (3.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-5</td>
      <td class="gt_row gt_center">179 (0.6%)</td>
      <td class="gt_row gt_center">8,597 (7.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-4</td>
      <td class="gt_row gt_center">319 (1.1%)</td>
      <td class="gt_row gt_center">18,726 (15%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-3</td>
      <td class="gt_row gt_center">627 (2.2%)</td>
      <td class="gt_row gt_center">22,086 (18%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-2</td>
      <td class="gt_row gt_center">1,561 (5.4%)</td>
      <td class="gt_row gt_center">23,869 (20%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-1</td>
      <td class="gt_row gt_center">25,448 (89%)</td>
      <td class="gt_row gt_center">42,150 (34%)</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="3">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          n (%)
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
</div>
</div>
<div id="diptheria" class="section level3">
<h3>Diptheria</h3>
<pre class="r"><code>diptheria &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;diptheria.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)
diptheria$vacweek &lt;- week(diptheria$vacdate)

dip &lt;- diptheria[, .N, by = .(vacyear, vacmonth)]
dip2 &lt;- diptheria[, .N, by = .(vacyear, vacmonth, vacweek)]
dip_delay &lt;- diptheria[, .N, by = .(vacyear, vacmonth, vacdelay, vacname2)]</code></pre>
<div id="overall-2" class="section level4">
<h4>Overall</h4>
<pre class="r"><code>ggplot(data = dip[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 200, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Diptheria vaccination shot by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;diptheria_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(dip[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacmonth, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 200, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Diptheria vaccination shot by month and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;diptheria_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = dip2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacweek), y = N/1000, color = factor(vacyear))) +
  #geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Diptheria vaccination shot by week and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;diptheria_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(dip2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacweek, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 100, by = 20)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Diptheria vaccination shot by week and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-35-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;diptheria_week_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="delays-in-diptheria-vaccination-months" class="section level4">
<h4>Delays in Diptheria vaccination (months)</h4>
<pre class="r"><code>ggplot(data = diptheria[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = vacdelay, y = factor(vacmonth), color = factor(vacyear))) +
  geom_density_ridges() +
  theme_ridges() + 
  theme(legend.position = &quot;none&quot;) +
  facet_grid(vacname2~ vacyear, scale = &quot;free_y&quot;) +
  labs(y = &quot;Months in year&quot;, x=&quot;Duration of delays in Diptheria vaccination (months)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  ggtitle(&quot;Delays in Diptheria vaccination (months) by month and year&quot;)</code></pre>
<pre><code>Picking joint bandwidth of 1.91</code></pre>
<pre><code>Picking joint bandwidth of 0.704</code></pre>
<pre><code>Picking joint bandwidth of 0.0833</code></pre>
<pre><code>Picking joint bandwidth of 0.157</code></pre>
<pre><code>Picking joint bandwidth of 0.128</code></pre>
<pre><code>Picking joint bandwidth of 0.072</code></pre>
<pre><code>Picking joint bandwidth of 0.194</code></pre>
<pre><code>Picking joint bandwidth of 0.0802</code></pre>
<pre><code>Picking joint bandwidth of NaN
Picking joint bandwidth of NaN</code></pre>
<pre><code>Picking joint bandwidth of 3.85</code></pre>
<pre><code>Picking joint bandwidth of 10</code></pre>
<pre><code>Warning: Removed 214576 rows containing non-finite values (stat_density_ridges).</code></pre>
<pre><code>Warning in FUN(X[[i]], ...): no non-missing arguments to max; returning -Inf

Warning in FUN(X[[i]], ...): no non-missing arguments to max; returning -Inf</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;diptheria_delay_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="check-date-of-diptheria-vaccination-before-schedule" class="section level4">
<h4>Check Date of Diptheria vaccination before schedule</h4>
<pre class="r"><code>diptheria_check1 &lt;- diptheria[vacdelay &lt; 0 &amp; vacname2==&quot;DPT&quot;]
diptheria_check1$type &lt;- &quot;Date of DPT vaccination before schedule (18th month)&quot;
nrow(diptheria_check1)</code></pre>
<pre><code>[1] 26353</code></pre>
<pre class="r"><code>nrow(diptheria[vacname2==&quot;DPT&quot;])</code></pre>
<pre><code>[1] 1132615</code></pre>
<pre class="r"><code>range(diptheria_check1$vacdate)</code></pre>
<pre><code>[1] &quot;2017-01-05&quot; &quot;2020-12-30&quot;</code></pre>
<pre class="r"><code>table(diptheria_check1$province)</code></pre>
<pre><code>
  Bac Giang     Bac Kan    Bac Ninh    Cao Bang   Dien Bien    Ha Giang 
        523          36        1080         227         824        1019 
     Ha Nam      Ha Noi     Ha Tinh   Hai Duong   Hai Phong    Hoa Binh 
        292        1262         468         845         947         458 
   Hung Yen    Lai Chau    Lang Son     Lao Cai    Nam Dinh     Nghe An 
        534         986         877        1019         345        2034 
  Ninh Binh     Phu Tho  Quang Ninh      Son La   Thai Binh Thai Nguyen 
        171        1896         281        1618         472         381 
  Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
       5107         953         952         746 </code></pre>
<pre class="r"><code>head(diptheria_check1)</code></pre>
<pre><code>               pid province district           commune sex        dob vacname
1: 101010120170465   Ha Noi Hoai Duc        Duc Thuong   1 2017-07-05     DPT
2: 101010120190002   Ha Noi  Gia Lam           Dong Du   1 2019-01-01     DPT
3: 101010320170279   Ha Noi  Ba Dinh Nguyen Trung Truc   1 2017-06-29     DPT
4: 101010520180070   Ha Noi  Ba Dinh        Quan Thanh   0 2018-04-23     DPT
5: 101011120170095   Ha Nam Binh Luc           Ngoc Lu   1 2017-04-05     DPT
6: 101011120180319   Ha Noi Cau Giay     Dich Vong Hau   1 2018-03-23     DPT
   vacname2 epi tub heb dip per tes hib pol msl rub jev shot start    vacdate
1:      DPT   1   0   0   1   1   1   0   0   0   0   0    1    18 2018-10-01
2:      DPT   1   0   0   1   1   1   0   0   0   0   0    1    18 2020-06-17
3:      DPT   1   0   0   1   1   1   0   0   0   0   0    1    18 2018-12-19
4:      DPT   1   0   0   1   1   1   0   0   0   0   0    1    18 2019-09-28
5:      DPT   1   0   0   1   1   1   0   0   0   0   0    1    18 2018-01-16
6:      DPT   1   0   0   1   1   1   0   0   0   0   0    1    18 2019-09-17
   vacyear vacmonth vacage vacdelay vacweek
1:    2018       10     14       -4      40
2:    2020        6     17       -1      25
3:    2018       12     17       -1      51
4:    2019        9     17       -1      39
5:    2018        1      9       -9       3
6:    2019        9     17       -1      38
                                                   type
1: Date of DPT vaccination before schedule (18th month)
2: Date of DPT vaccination before schedule (18th month)
3: Date of DPT vaccination before schedule (18th month)
4: Date of DPT vaccination before schedule (18th month)
5: Date of DPT vaccination before schedule (18th month)
6: Date of DPT vaccination before schedule (18th month)</code></pre>
<pre class="r"><code>#26353/1132615*100 = 2.33%

diptheria_check2 &lt;- diptheria[vacdelay &lt; 0 &amp; vacname2==&quot;DPT_HepB_Hib&quot;]
diptheria_check2$type &lt;- &quot;Date of DPT-HepB-Hib vaccination before schedule (2th month)&quot;
nrow(diptheria_check2)</code></pre>
<pre><code>[1] 46154</code></pre>
<pre class="r"><code>nrow(diptheria[vacname2==&quot;DPT_HepB_Hib&quot;])</code></pre>
<pre><code>[1] 6512205</code></pre>
<pre class="r"><code>range(diptheria_check2$vacdate)</code></pre>
<pre><code>[1] &quot;2017-01-04&quot; &quot;2020-12-30&quot;</code></pre>
<pre class="r"><code>table(diptheria_check2$province)</code></pre>
<pre><code>
  Bac Giang     Bac Kan    Bac Ninh    Cao Bang   Dien Bien    Ha Giang 
       1978         125         756         959        1395        3304 
     Ha Nam      Ha Noi     Ha Tinh   Hai Duong   Hai Phong    Hoa Binh 
        919        1966        1304        2038        1144         788 
   Hung Yen    Lai Chau    Lang Son     Lao Cai    Nam Dinh     Nghe An 
       1694        1831        1068        1368        1430        5651 
  Ninh Binh     Phu Tho  Quang Ninh      Son La   Thai Binh Thai Nguyen 
        795         758        1091        2743        2005        1061 
  Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
       4111        1442        1227        1203 </code></pre>
<pre class="r"><code>head(diptheria_check2)</code></pre>
<pre><code>               pid province district           commune sex        dob
1: 101010120190374   Ha Noi  Ba Dinh           Phuc Xa   0 2019-10-05
2: 101010320180079   Ha Noi  Ba Dinh Nguyen Trung Truc   1 2018-05-02
3: 101010520170015   Ha Noi  Ba Dinh        Quan Thanh   0 2017-02-18
4: 101010720180123   Ha Noi  Ba Dinh         Truc Bach   0 2018-09-27
5: 101011120200187   Ha Noi  Ba Dinh            Kim Ma   0 2020-09-14
6: 101011420170044   Ha Noi  Ba Dinh         Lieu Giai   0 2017-02-06
      vacname     vacname2 epi tub heb dip per tes hib pol msl rub jev shot
1: ComBE Five DPT_HepB_Hib   1   0   1   1   1   1   1   0   0   0   0    1
2:  Quinvaxem DPT_HepB_Hib   1   0   1   1   1   1   1   0   0   0   0    1
3:  Quinvaxem DPT_HepB_Hib   1   0   1   1   1   1   1   0   0   0   0    1
4: ComBE Five DPT_HepB_Hib   1   0   1   1   1   1   1   0   0   0   0    1
5: ComBE Five DPT_HepB_Hib   1   0   1   1   1   1   1   0   0   0   0    1
6:  Quinvaxem DPT_HepB_Hib   1   0   1   1   1   1   1   0   0   0   0    1
   start    vacdate vacyear vacmonth vacage vacdelay vacweek
1:     2 2019-12-04    2019       12      1       -1      49
2:     2 2018-06-06    2018        6      1       -1      23
3:     2 2017-03-05    2017        3      0       -2      10
4:     2 2018-11-06    2018       11      1       -1      45
5:     2 2020-11-03    2020       11      1       -1      44
6:     2 2017-04-04    2017        4      1       -1      14
                                                           type
1: Date of DPT-HepB-Hib vaccination before schedule (2th month)
2: Date of DPT-HepB-Hib vaccination before schedule (2th month)
3: Date of DPT-HepB-Hib vaccination before schedule (2th month)
4: Date of DPT-HepB-Hib vaccination before schedule (2th month)
5: Date of DPT-HepB-Hib vaccination before schedule (2th month)
6: Date of DPT-HepB-Hib vaccination before schedule (2th month)</code></pre>
<pre class="r"><code>#46154/6512205*100 = 0.71%

diptheria_check3 &lt;- diptheria[vacdelay &lt; 0 &amp; vacname2==&quot;Td&quot;]
diptheria_check3$type &lt;- &quot;Date of Td vaccination before schedule (84th month)&quot;
nrow(diptheria_check3)</code></pre>
<pre><code>[1] 239</code></pre>
<pre class="r"><code>nrow(diptheria[vacname2==&quot;Td&quot;])</code></pre>
<pre><code>[1] 240</code></pre>
<pre class="r"><code>range(diptheria_check3$vacdate)</code></pre>
<pre><code>[1] &quot;2017-08-25&quot; &quot;2020-12-24&quot;</code></pre>
<pre class="r"><code>table(diptheria_check3$province)</code></pre>
<pre><code>
  Bac Giang    Bac Ninh    Cao Bang   Dien Bien    Ha Giang      Ha Noi 
          6           2          10          12          13           5 
    Ha Tinh   Hai Duong   Hai Phong    Hung Yen    Lai Chau     Lao Cai 
          2           3           9           2           6          27 
   Nam Dinh     Nghe An   Ninh Binh     Phu Tho  Quang Ninh      Son La 
          1           9           1           5          16          57 
  Thai Binh Thai Nguyen   Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
          6           1          28           7           3           8 </code></pre>
<pre class="r"><code>head(diptheria_check3)</code></pre>
<pre><code>               pid  province  district    commune sex        dob
1: 101472920190006    Ha Noi    My Duc   Dai Hung   0 2019-01-10
2: 101472920190075    Ha Noi    My Duc   Dai Hung   0 2019-07-23
3: 101510520200106    Ha Noi Phu Xuyen  Hong Minh   0 2020-12-21
4: 101530120180234    Ha Noi   Me Linh Quang Minh   1 2018-08-12
5: 103030920200099 Hai Phong Ngo Quyen    Cau Tre   0 2020-05-22
6: 103050520190386 Hai Phong   Le Chan   Nghia Xa   0 2019-12-15
                                                 vacname vacname2 epi tub heb
1: Vac xin uon van bach hau hap phu (Td) (Hop 10 lo 5ml)       Td   0   0   0
2: Vac xin uon van bach hau hap phu (Td) (Hop 10 lo 5ml)       Td   0   0   0
3: Vac xin uon van bach hau hap phu (Td) (Hop 10 lo 5ml)       Td   0   0   0
4: Vac xin uon van bach hau hap phu (Td) (Hop 10 lo 5ml)       Td   0   0   0
5: Vac xin uon van bach hau hap phu (Td) (Hop 10 lo 5ml)       Td   0   0   0
6: Vac xin uon van bach hau hap phu (Td) (Hop 10 lo 5ml)       Td   0   0   0
   dip per tes hib pol msl rub jev shot start    vacdate vacyear vacmonth
1:   1   0   1   0   0   0   0   0    1    84 2020-08-30    2020        8
2:   1   0   1   0   0   0   0   0    1    84 2020-08-29    2020        8
3:   1   0   1   0   0   0   0   0    1    84 2020-12-21    2020       12
4:   1   0   1   0   0   0   0   0    1    84 2020-12-13    2020       12
5:   1   0   1   0   0   0   0   0    1    84 2020-05-28    2020        5
6:   1   0   1   0   0   0   0   0    1    84 2019-12-15    2019       12
   vacage vacdelay vacweek                                                type
1:     19      -65      35 Date of Td vaccination before schedule (84th month)
2:     13      -71      35 Date of Td vaccination before schedule (84th month)
3:      0      -84      51 Date of Td vaccination before schedule (84th month)
4:     28      -56      50 Date of Td vaccination before schedule (84th month)
5:      0      -84      22 Date of Td vaccination before schedule (84th month)
6:      0      -84      50 Date of Td vaccination before schedule (84th month)</code></pre>
<pre class="r"><code>#239/240*100 = 99.6%

data_path &lt;- file.path(&quot;..&quot;, &quot;tuann349_vad&quot;)

diptheria_check &lt;- rbindlist(l = list(diptheria_check1[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)],
                                      diptheria_check2[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)],
                                      diptheria_check3[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)]))
#fwrite(x = diptheria_check, file = file.path(data_path, &quot;check_diptheria.csv&quot;))</code></pre>
<pre class="r"><code>head(diptheria_check)</code></pre>
<pre><code>               pid province district           commune sex        dob vacname2
1: 101010120170465   Ha Noi Hoai Duc        Duc Thuong   1 2017-07-05      DPT
2: 101010120190002   Ha Noi  Gia Lam           Dong Du   1 2019-01-01      DPT
3: 101010320170279   Ha Noi  Ba Dinh Nguyen Trung Truc   1 2017-06-29      DPT
4: 101010520180070   Ha Noi  Ba Dinh        Quan Thanh   0 2018-04-23      DPT
5: 101011120170095   Ha Nam Binh Luc           Ngoc Lu   1 2017-04-05      DPT
6: 101011120180319   Ha Noi Cau Giay     Dich Vong Hau   1 2018-03-23      DPT
      vacdate vacdelay                                                 type
1: 2018-10-01       -4 Date of DPT vaccination before schedule (18th month)
2: 2020-06-17       -1 Date of DPT vaccination before schedule (18th month)
3: 2018-12-19       -1 Date of DPT vaccination before schedule (18th month)
4: 2019-09-28       -1 Date of DPT vaccination before schedule (18th month)
5: 2018-01-16       -9 Date of DPT vaccination before schedule (18th month)
6: 2019-09-17       -1 Date of DPT vaccination before schedule (18th month)</code></pre>
<pre class="r"><code>diptheria_check %&gt;% select(-pid, -district, -commune, -type) %&gt;% mutate(vacdelay=factor(vacdelay)) %&gt;% tbl_summary(., by=vacname2)</code></pre>
<pre><code>Column(s) &#39;dob&#39;, and &#39;vacdate&#39; omitted from output.
Accepted classes are &#39;character&#39;, &#39;factor&#39;, &#39;numeric&#39;, &#39;logical&#39;, &#39;integer&#39;, or &#39;difftime&#39;.</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#olbtphkqnc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#olbtphkqnc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#olbtphkqnc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#olbtphkqnc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#olbtphkqnc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#olbtphkqnc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#olbtphkqnc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#olbtphkqnc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#olbtphkqnc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#olbtphkqnc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#olbtphkqnc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#olbtphkqnc .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#olbtphkqnc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#olbtphkqnc .gt_from_md > :first-child {
  margin-top: 0;
}

#olbtphkqnc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#olbtphkqnc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#olbtphkqnc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#olbtphkqnc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#olbtphkqnc .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#olbtphkqnc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#olbtphkqnc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#olbtphkqnc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#olbtphkqnc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#olbtphkqnc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#olbtphkqnc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#olbtphkqnc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#olbtphkqnc .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#olbtphkqnc .gt_left {
  text-align: left;
}

#olbtphkqnc .gt_center {
  text-align: center;
}

#olbtphkqnc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#olbtphkqnc .gt_font_normal {
  font-weight: normal;
}

#olbtphkqnc .gt_font_bold {
  font-weight: bold;
}

#olbtphkqnc .gt_font_italic {
  font-style: italic;
}

#olbtphkqnc .gt_super {
  font-size: 65%;
}

#olbtphkqnc .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="olbtphkqnc" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>DPT</strong>, N = 26,353<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>DPT_HepB_Hib</strong>, N = 46,154<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Td</strong>, N = 239<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">province</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Giang</td>
      <td class="gt_row gt_center">523 (2.0%)</td>
      <td class="gt_row gt_center">1,978 (4.3%)</td>
      <td class="gt_row gt_center">6 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Kan</td>
      <td class="gt_row gt_center">36 (0.1%)</td>
      <td class="gt_row gt_center">125 (0.3%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Ninh</td>
      <td class="gt_row gt_center">1,080 (4.1%)</td>
      <td class="gt_row gt_center">756 (1.6%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Cao Bang</td>
      <td class="gt_row gt_center">227 (0.9%)</td>
      <td class="gt_row gt_center">959 (2.1%)</td>
      <td class="gt_row gt_center">10 (4.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Dien Bien</td>
      <td class="gt_row gt_center">824 (3.1%)</td>
      <td class="gt_row gt_center">1,395 (3.0%)</td>
      <td class="gt_row gt_center">12 (5.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Giang</td>
      <td class="gt_row gt_center">1,019 (3.9%)</td>
      <td class="gt_row gt_center">3,304 (7.2%)</td>
      <td class="gt_row gt_center">13 (5.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Nam</td>
      <td class="gt_row gt_center">292 (1.1%)</td>
      <td class="gt_row gt_center">919 (2.0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Noi</td>
      <td class="gt_row gt_center">1,262 (4.8%)</td>
      <td class="gt_row gt_center">1,966 (4.3%)</td>
      <td class="gt_row gt_center">5 (2.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Tinh</td>
      <td class="gt_row gt_center">468 (1.8%)</td>
      <td class="gt_row gt_center">1,304 (2.8%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Duong</td>
      <td class="gt_row gt_center">845 (3.2%)</td>
      <td class="gt_row gt_center">2,038 (4.4%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Phong</td>
      <td class="gt_row gt_center">947 (3.6%)</td>
      <td class="gt_row gt_center">1,144 (2.5%)</td>
      <td class="gt_row gt_center">9 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hoa Binh</td>
      <td class="gt_row gt_center">458 (1.7%)</td>
      <td class="gt_row gt_center">788 (1.7%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hung Yen</td>
      <td class="gt_row gt_center">534 (2.0%)</td>
      <td class="gt_row gt_center">1,694 (3.7%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lai Chau</td>
      <td class="gt_row gt_center">986 (3.7%)</td>
      <td class="gt_row gt_center">1,831 (4.0%)</td>
      <td class="gt_row gt_center">6 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lang Son</td>
      <td class="gt_row gt_center">877 (3.3%)</td>
      <td class="gt_row gt_center">1,068 (2.3%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lao Cai</td>
      <td class="gt_row gt_center">1,019 (3.9%)</td>
      <td class="gt_row gt_center">1,368 (3.0%)</td>
      <td class="gt_row gt_center">27 (11%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nam Dinh</td>
      <td class="gt_row gt_center">345 (1.3%)</td>
      <td class="gt_row gt_center">1,430 (3.1%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nghe An</td>
      <td class="gt_row gt_center">2,034 (7.7%)</td>
      <td class="gt_row gt_center">5,651 (12%)</td>
      <td class="gt_row gt_center">9 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ninh Binh</td>
      <td class="gt_row gt_center">171 (0.6%)</td>
      <td class="gt_row gt_center">795 (1.7%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Phu Tho</td>
      <td class="gt_row gt_center">1,896 (7.2%)</td>
      <td class="gt_row gt_center">758 (1.6%)</td>
      <td class="gt_row gt_center">5 (2.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Quang Ninh</td>
      <td class="gt_row gt_center">281 (1.1%)</td>
      <td class="gt_row gt_center">1,091 (2.4%)</td>
      <td class="gt_row gt_center">16 (6.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Son La</td>
      <td class="gt_row gt_center">1,618 (6.1%)</td>
      <td class="gt_row gt_center">2,743 (5.9%)</td>
      <td class="gt_row gt_center">57 (24%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Binh</td>
      <td class="gt_row gt_center">472 (1.8%)</td>
      <td class="gt_row gt_center">2,005 (4.3%)</td>
      <td class="gt_row gt_center">6 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Nguyen</td>
      <td class="gt_row gt_center">381 (1.4%)</td>
      <td class="gt_row gt_center">1,061 (2.3%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thanh Hoa</td>
      <td class="gt_row gt_center">5,107 (19%)</td>
      <td class="gt_row gt_center">4,111 (8.9%)</td>
      <td class="gt_row gt_center">28 (12%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Tuyen Quang</td>
      <td class="gt_row gt_center">953 (3.6%)</td>
      <td class="gt_row gt_center">1,442 (3.1%)</td>
      <td class="gt_row gt_center">7 (2.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Vinh Phuc</td>
      <td class="gt_row gt_center">952 (3.6%)</td>
      <td class="gt_row gt_center">1,227 (2.7%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Yen Bai</td>
      <td class="gt_row gt_center">746 (2.8%)</td>
      <td class="gt_row gt_center">1,203 (2.6%)</td>
      <td class="gt_row gt_center">8 (3.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sex</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0</td>
      <td class="gt_row gt_center">13,828 (52%)</td>
      <td class="gt_row gt_center">24,006 (52%)</td>
      <td class="gt_row gt_center">122 (51%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">1</td>
      <td class="gt_row gt_center">12,524 (48%)</td>
      <td class="gt_row gt_center">22,148 (48%)</td>
      <td class="gt_row gt_center">117 (49%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">2</td>
      <td class="gt_row gt_center">1 (&lt;0.1%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">vacdelay</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-84</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">62 (26%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-83</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">19 (7.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-82</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">8 (3.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-81</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">14 (5.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-80</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">12 (5.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-79</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">12 (5.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-78</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">6 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-77</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">12 (5.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-76</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">5 (2.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-75</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-74</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">6 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-73</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-72</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-71</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-69</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-68</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-67</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-66</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">7 (2.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-65</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-64</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">5 (2.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-63</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-61</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-60</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-59</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">5 (2.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-58</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-57</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-56</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-55</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">3 (1.3%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-54</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-52</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-51</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">2 (0.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-50</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">6 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-49</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-48</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">4 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-45</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-44</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-37</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">1 (0.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-18</td>
      <td class="gt_row gt_center">51 (0.2%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-17</td>
      <td class="gt_row gt_center">35 (0.1%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-16</td>
      <td class="gt_row gt_center">111 (0.4%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-15</td>
      <td class="gt_row gt_center">89 (0.3%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-14</td>
      <td class="gt_row gt_center">106 (0.4%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-13</td>
      <td class="gt_row gt_center">113 (0.4%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-12</td>
      <td class="gt_row gt_center">257 (1.0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-11</td>
      <td class="gt_row gt_center">221 (0.8%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-10</td>
      <td class="gt_row gt_center">181 (0.7%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-9</td>
      <td class="gt_row gt_center">251 (1.0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-8</td>
      <td class="gt_row gt_center">262 (1.0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-7</td>
      <td class="gt_row gt_center">454 (1.7%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-6</td>
      <td class="gt_row gt_center">3,144 (12%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-5</td>
      <td class="gt_row gt_center">2,846 (11%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-4</td>
      <td class="gt_row gt_center">2,013 (7.6%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-3</td>
      <td class="gt_row gt_center">1,537 (5.8%)</td>
      <td class="gt_row gt_center">6 (&lt;0.1%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-2</td>
      <td class="gt_row gt_center">1,870 (7.1%)</td>
      <td class="gt_row gt_center">1,509 (3.3%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-1</td>
      <td class="gt_row gt_center">12,812 (49%)</td>
      <td class="gt_row gt_center">44,639 (97%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="4">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          n (%)
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
</div>
</div>
<div id="tuberculosis" class="section level3">
<h3>Tuberculosis</h3>
<pre class="r"><code>tuberculosis &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;tuberculosis.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)
tuberculosis$vacweek &lt;- week(tuberculosis$vacdate)

tub &lt;- tuberculosis[, .N, by = .(vacyear, vacmonth)]
tub2 &lt;- tuberculosis[, .N, by = .(vacyear, vacmonth, vacweek)]
tub_delay &lt;- tuberculosis[, .N, by = .(vacyear, vacmonth, vacdelay, vacname2)]</code></pre>
<div id="overall-3" class="section level4">
<h4>Overall</h4>
<pre class="r"><code>ggplot(data = tub[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 200, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Tuberculosis vaccination shot by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;tuberclulosis_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(tub[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacmonth, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 200, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Tuberculosis vaccination shot by month and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-44-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;tuberclulosis_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = tub2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacweek), y = N/1000, color = factor(vacyear))) +
  #geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 60, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Tuberculosis vaccination shot by week and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-45-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;tuberclulosis_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(tub2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacweek, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 60, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Tuberculosis vaccination shot by week and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-46-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;tuberclulosis_week_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="delays-in-tuberculosis-vaccination-months" class="section level4">
<h4>Delays in Tuberculosis vaccination (months)</h4>
<pre class="r"><code>ggplot(data = tuberculosis[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = vacdelay, y = factor(vacmonth), color = factor(vacyear))) +
  geom_density_ridges() +
  theme_ridges() + 
  theme(legend.position = &quot;none&quot;) +
  facet_grid(vacname2~ vacyear, scale = &quot;free_y&quot;) +
  labs(y = &quot;Months in year&quot;, x=&quot;Duration of delays in Tuberculosis vaccination (months)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  ggtitle(&quot;Delays in Tuberculosis vaccination (months) by month and year&quot;)</code></pre>
<pre><code>Picking joint bandwidth of 0.0732</code></pre>
<pre><code>Picking joint bandwidth of 0.0727</code></pre>
<pre><code>Picking joint bandwidth of 0.0724</code></pre>
<pre><code>Picking joint bandwidth of 0.0738</code></pre>
<pre><code>Warning: Removed 4030 rows containing non-finite values (stat_density_ridges).</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-49-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;tuberculosis_delay_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="check-date-of-tuberculosis-vaccination-before-schedule" class="section level4">
<h4>Check Date of Tuberculosis vaccination before schedule</h4>
<pre class="r"><code>tuberculosis_check &lt;- tuberculosis[vacdelay &lt; 0 &amp; vacname2==&quot;BCG&quot;]
tuberculosis_check$type &lt;- &quot;Date of BCG vaccination before schedule (0th month)&quot;
nrow(tuberculosis_check)</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code>nrow(tuberculosis[vacname2==&quot;BCG&quot;])</code></pre>
<pre><code>[1] 3203129</code></pre>
<pre class="r"><code>range(tuberculosis_check$vacdate)</code></pre>
<pre><code>Warning in min.default(structure(numeric(0), class = &quot;Date&quot;), na.rm = FALSE): no
non-missing arguments to min; returning Inf</code></pre>
<pre><code>Warning in max.default(structure(numeric(0), class = &quot;Date&quot;), na.rm = FALSE): no
non-missing arguments to max; returning -Inf</code></pre>
<pre><code>[1] NA NA</code></pre>
<pre class="r"><code>table(tuberculosis_check$province)</code></pre>
<pre><code>&lt; table of extent 0 &gt;</code></pre>
<pre class="r"><code>head(tuberculosis_check)</code></pre>
<pre><code>Empty data.table (0 rows and 28 cols): pid,province,district,commune,sex,dob...</code></pre>
<pre class="r"><code>#0/3203129*100 = 0%</code></pre>
</div>
</div>
<div id="hepatitis-b" class="section level3">
<h3>Hepatitis B</h3>
<pre class="r"><code>hepatitisb &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;hepatitisb.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)
hepatitisb$vacweek &lt;- week(hepatitisb$vacdate)

hep &lt;- hepatitisb[, .N, by = .(vacyear, vacmonth)]
hep2 &lt;- hepatitisb[, .N, by = .(vacyear, vacmonth, vacweek)]
hep_delay &lt;- hepatitisb[, .N, by = .(vacyear, vacmonth, vacdelay, vacname2)]</code></pre>
<div id="overall-4" class="section level4">
<h4>Overall</h4>
<pre class="r"><code>ggplot(data = hep[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 300, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Hepatitis B vaccination shot by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-52-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;hepatitisb_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(hep[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacmonth, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 300, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Hepatitis B vaccination shot by month and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-53-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;hepatitisb_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = hep2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacweek), y = N/1000, color = factor(vacyear))) +
  #geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Hepatitis B vaccination shot by week and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-54-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;hepatitisb_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(hep2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacweek, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Hepatitis B vaccination shot by week and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-55-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;hepatitisb_week_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="delays-in-hepatitis-b-vaccination-months" class="section level4">
<h4>Delays in Hepatitis B vaccination (months)</h4>
<pre class="r"><code>ggplot(data = hepatitisb[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = vacdelay, y = factor(vacmonth), color = factor(vacyear))) +
  geom_density_ridges() +
  theme_ridges() + 
  theme(legend.position = &quot;none&quot;) +
  facet_grid(vacname2~ vacyear, scale = &quot;free_y&quot;) +
  labs(y = &quot;Months in year&quot;, x=&quot;Duration of delays in Hepatitis B vaccination (months)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  ggtitle(&quot;Delays in Hepatitis B vaccination (months) by month and year&quot;)</code></pre>
<pre><code>Picking joint bandwidth of 0.128</code></pre>
<pre><code>Picking joint bandwidth of 0.072</code></pre>
<pre><code>Picking joint bandwidth of 0.194</code></pre>
<pre><code>Picking joint bandwidth of 0.0802</code></pre>
<pre><code>Picking joint bandwidth of 0.0277</code></pre>
<pre><code>Picking joint bandwidth of 0.0442</code></pre>
<pre><code>Picking joint bandwidth of 0.14</code></pre>
<pre><code>Picking joint bandwidth of 0.126</code></pre>
<pre><code>Warning: Removed 231138 rows containing non-finite values (stat_density_ridges).</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-58-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ggsave(filename = file.path(&quot;figures&quot;, &quot;hepatitisb_delay_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre><code>Picking joint bandwidth of 0.128</code></pre>
<pre><code>Picking joint bandwidth of 0.072</code></pre>
<pre><code>Picking joint bandwidth of 0.194</code></pre>
<pre><code>Picking joint bandwidth of 0.0802</code></pre>
<pre><code>Picking joint bandwidth of 0.0277</code></pre>
<pre><code>Picking joint bandwidth of 0.0442</code></pre>
<pre><code>Picking joint bandwidth of 0.14</code></pre>
<pre><code>Picking joint bandwidth of 0.126</code></pre>
<pre><code>Warning: Removed 231138 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div id="check-date-of-hepatitis-b-vaccination-before-schedule" class="section level4">
<h4>Check Date of Hepatitis B vaccination before schedule</h4>
<pre class="r"><code>hepatitisb_check &lt;- hepatitisb[vacdelay &lt; 0 &amp; vacname2==&quot;HepBN&quot;]
hepatitisb_check$type &lt;- &quot;Date of HepBN vaccination before schedule (0th month)&quot;
nrow(hepatitisb_check)</code></pre>
<pre><code>[1] 0</code></pre>
<pre class="r"><code>nrow(hepatitisb[vacname2==&quot;HepBN&quot;])</code></pre>
<pre><code>[1] 2473433</code></pre>
<pre class="r"><code>range(hepatitisb_check$vacdate)</code></pre>
<pre><code>Warning in min.default(structure(numeric(0), class = &quot;Date&quot;), na.rm = FALSE): no
non-missing arguments to min; returning Inf</code></pre>
<pre><code>Warning in max.default(structure(numeric(0), class = &quot;Date&quot;), na.rm = FALSE): no
non-missing arguments to max; returning -Inf</code></pre>
<pre><code>[1] NA NA</code></pre>
<pre class="r"><code>table(hepatitisb_check$province)</code></pre>
<pre><code>&lt; table of extent 0 &gt;</code></pre>
<pre class="r"><code>head(hepatitisb_check)</code></pre>
<pre><code>Empty data.table (0 rows and 28 cols): pid,province,district,commune,sex,dob...</code></pre>
<pre class="r"><code>#0/2473433*100 = 0%</code></pre>
</div>
</div>
<div id="polio" class="section level3">
<h3>Polio</h3>
<pre class="r"><code>polio &lt;- readRDS(file = file.path(&quot;..&quot;, &quot;tuann349_vad&quot;, &quot;polio.rds&quot;)) %&gt;% filter(!pid %in% error_datetime$pid &amp; !pid %in% error_duplicate$pid)
polio$vacweek &lt;- week(polio$vacdate)

pol &lt;- polio[, .N, by = .(vacyear, vacmonth)]
pol2 &lt;- polio[, .N, by = .(vacyear, vacmonth, vacweek)]
pol_delay &lt;- polio[, .N, by = .(vacyear, vacmonth, vacdelay, vacname2)]</code></pre>
<div id="overall-5" class="section level4">
<h4>Overall</h4>
<pre class="r"><code>ggplot(data = pol[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacmonth), y = N/1000, color = factor(vacyear))) +
  geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Month&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 300, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Polio vaccination shot by month and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-61-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;polio_month_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(pol[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacmonth, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Month&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 300, by = 50)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Polio vaccination shot by month and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;polio_month_year2.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(data = pol2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = factor(vacweek), y = N/1000, color = factor(vacyear))) +
  #geom_rect(aes(xmin = 3, xmax = 5, ymin = -Inf, ymax = Inf), fill = &quot;grey80&quot;, color = &quot;grey90&quot;, alpha = 0.015) +
  geom_point(size = 3) +
  geom_line(aes(group = vacyear), size = 1.5) +
  scale_x_discrete(name = &quot;Week&quot;) +
  geom_smooth() +
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1.5) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Polio vaccination shot by week and year&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-63-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;polio_week_year.png&quot;), width = 7, height = 5)</code></pre>
<pre class="r"><code>ggplot(pol2[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(vacweek, N/1000, color = factor(vacyear))) +
  geom_point(size=3) +
  geom_line(aes(group=vacyear)) +
  geom_smooth () + 
  stat_smooth(method=&quot;loess&quot;, formula = y ~ x, colour=&quot;blue&quot;, size=1) +
  scale_x_discrete(name = &quot;Week&quot;) +
  scale_y_continuous(name = &quot;Number of shot (x 10^3)&quot;, breaks = seq(from = 0, to = 100, by = 10)) +
  scale_color_discrete(name = &quot;Year&quot;) +
  theme_bw() +
  ggtitle(&quot;Total number of Polio vaccination shot by week and year&quot;) +
  facet_wrap(~ vacyear, scale = &quot;free_y&quot;)</code></pre>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-64-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;polio_week_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="delays-in-polio-vaccination-months" class="section level4">
<h4>Delays in Polio vaccination (months)</h4>
<pre class="r"><code>ggplot(data = polio[vacyear &gt;= 2017 &amp; vacyear &lt;= 2020], aes(x = vacdelay, y = factor(vacmonth), color = factor(vacyear))) +
  geom_density_ridges() +
  theme_ridges() + 
  theme(legend.position = &quot;none&quot;) +
  facet_grid(vacname2~ vacyear, scale = &quot;free_y&quot;) +
  labs(y = &quot;Months in year&quot;, x=&quot;Duration of delays in Polio vaccination (months)&quot;) +
  scale_color_discrete(name = &quot;Year&quot;) +
  ggtitle(&quot;Delays in Polio vaccination (months) by month and year&quot;)</code></pre>
<pre><code>Picking joint bandwidth of 1.26</code></pre>
<pre><code>Picking joint bandwidth of 0.783</code></pre>
<pre><code>Picking joint bandwidth of 0.214</code></pre>
<pre><code>Picking joint bandwidth of 0.399</code></pre>
<pre><code>Picking joint bandwidth of 0.128</code></pre>
<pre><code>Picking joint bandwidth of 0.0602</code></pre>
<pre><code>Picking joint bandwidth of 0.0963</code></pre>
<pre><code>Picking joint bandwidth of 0.0808</code></pre>
<pre><code>Warning: Removed 45504 rows containing non-finite values (stat_density_ridges).</code></pre>
<p><img src="figure/02_data_exploration.Rmd/unnamed-chunk-67-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(filename = file.path(&quot;figures&quot;, &quot;polio_delay_year2.png&quot;), width = 7, height = 5)</code></pre>
</div>
<div id="check-date-of-polio-vaccination-before-schedule" class="section level4">
<h4>Check Date of Polio vaccination before schedule</h4>
<pre class="r"><code>polio_check1 &lt;- polio[vacdelay &lt; 0 &amp; vacname2==&quot;OPV&quot;]
polio_check1$type &lt;- &quot;Date of OPV vaccination before schedule (2th month)&quot;
nrow(polio_check1)</code></pre>
<pre><code>[1] 54191</code></pre>
<pre class="r"><code>nrow(polio[vacname2==&quot;OPV&quot;])</code></pre>
<pre><code>[1] 6508857</code></pre>
<pre class="r"><code>range(polio_check1$vacdate)</code></pre>
<pre><code>[1] &quot;2017-01-05&quot; &quot;2020-12-30&quot;</code></pre>
<pre class="r"><code>table(polio_check1$province)</code></pre>
<pre><code>
  Bac Giang     Bac Kan    Bac Ninh    Cao Bang   Dien Bien    Ha Giang 
       2093         133        1042        1364        1972        4169 
     Ha Nam      Ha Noi     Ha Tinh   Hai Duong   Hai Phong    Hoa Binh 
       1010        2082        1850        2358        1365         896 
   Hung Yen    Lai Chau    Lang Son     Lao Cai    Nam Dinh     Nghe An 
       1722        2144        1428        1714        1570        6891 
  Ninh Binh     Phu Tho  Quang Ninh      Son La   Thai Binh Thai Nguyen 
        795         891        1289        2922        2080        1107 
  Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
       4892        1712        1304        1396 </code></pre>
<pre class="r"><code>head(polio_check1)</code></pre>
<pre><code>               pid province district           commune sex        dob vacname
1: 101010120190374   Ha Noi  Ba Dinh           Phuc Xa   0 2019-10-05     OPV
2: 101010320180079   Ha Noi  Ba Dinh Nguyen Trung Truc   1 2018-05-02     OPV
3: 101010720180123   Ha Noi  Ba Dinh         Truc Bach   0 2018-09-27     OPV
4: 101011320170377   Ha Noi  Ba Dinh         Lieu Giai   0 2017-08-12     OPV
5: 101011320170377   Ha Noi  Ba Dinh         Lieu Giai   0 2017-08-12     OPV
6: 101011320170377   Ha Noi  Ba Dinh         Lieu Giai   0 2017-08-12     OPV
   vacname2 epi tub heb dip per tes hib pol msl rub jev shot start    vacdate
1:      OPV   1   0   0   0   0   0   0   1   0   0   0    1     2 2019-12-04
2:      OPV   1   0   0   0   0   0   0   1   0   0   0    1     2 2018-06-06
3:      OPV   1   0   0   0   0   0   0   1   0   0   0    1     2 2018-11-06
4:      OPV   1   0   0   0   0   0   0   1   0   0   0    1     2 2017-08-30
5:      OPV   1   0   0   0   0   0   0   1   0   0   0    2     3 2017-10-25
6:      OPV   1   0   0   0   0   0   0   1   0   0   0    3     4 2017-11-25
   vacyear vacmonth vacage vacdelay vacweek
1:    2019       12      1       -1      49
2:    2018        6      1       -1      23
3:    2018       11      1       -1      45
4:    2017        8      0       -2      35
5:    2017       10      2       -1      43
6:    2017       11      3       -1      47
                                                  type
1: Date of OPV vaccination before schedule (2th month)
2: Date of OPV vaccination before schedule (2th month)
3: Date of OPV vaccination before schedule (2th month)
4: Date of OPV vaccination before schedule (2th month)
5: Date of OPV vaccination before schedule (2th month)
6: Date of OPV vaccination before schedule (2th month)</code></pre>
<pre class="r"><code>#54191/6508857*100 = 0.83%

polio_check2 &lt;- polio[vacdelay &lt; 0 &amp; vacname2==&quot;IPV&quot;]
polio_check2$type &lt;- &quot;Date of IPV vaccination before schedule (5th month)&quot;
nrow(polio_check2)</code></pre>
<pre><code>[1] 8394</code></pre>
<pre class="r"><code>nrow(polio[vacname2==&quot;IPV&quot;])</code></pre>
<pre><code>[1] 1155541</code></pre>
<pre class="r"><code>range(polio_check2$vacdate)</code></pre>
<pre><code>[1] &quot;2017-02-18&quot; &quot;2020-12-28&quot;</code></pre>
<pre class="r"><code>table(polio_check2$province)</code></pre>
<pre><code>
  Bac Giang     Bac Kan    Bac Ninh    Cao Bang   Dien Bien    Ha Giang 
        370          11         333          67         641         446 
     Ha Nam      Ha Noi     Ha Tinh   Hai Duong   Hai Phong    Hoa Binh 
        233         328         197         304         209         152 
   Hung Yen    Lai Chau    Lang Son     Lao Cai    Nam Dinh     Nghe An 
        195         202          90         202         320         700 
  Ninh Binh     Phu Tho  Quang Ninh      Son La   Thai Binh Thai Nguyen 
         95         486         124         514         752         138 
  Thanh Hoa Tuyen Quang   Vinh Phuc     Yen Bai 
        680         103         268         234 </code></pre>
<pre class="r"><code>head(polio_check2)</code></pre>
<pre><code>               pid province     district    commune sex        dob vacname
1: 101011620200086   Ha Noi      Ba Dinh  Vinh Phuc   0 2020-04-26     IPV
2: 101070520180140   Ha Noi Hai Ba Trung  Nguyen Du   1 2018-11-11     IPV
3: 101081120200243   Ha Noi    Hoang Mai Thinh Liet   0 2020-06-10     IPV
4: 101081520181230   Ha Noi    Hoang Mai    Dai Kim   1 2018-09-01     IPV
5: 101090720180108   Ha Noi      Dong Da Van Chuong   0 2018-05-21     IPV
6: 101090720190222   Ha Noi      Dong Da Van Chuong   1 2019-08-16     IPV
   vacname2 epi tub heb dip per tes hib pol msl rub jev shot start    vacdate
1:      IPV   1   0   0   0   0   0   0   1   0   0   0    1     5 2020-09-23
2:      IPV   1   0   0   0   0   0   0   1   0   0   0    1     5 2019-02-12
3:      IPV   1   0   0   0   0   0   0   1   0   0   0    1     5 2020-11-03
4:      IPV   1   0   0   0   0   0   0   1   0   0   0    1     5 2019-01-07
5:      IPV   1   0   0   0   0   0   0   1   0   0   0    1     5 2018-10-17
6:      IPV   1   0   0   0   0   0   0   1   0   0   0    1     5 2020-01-15
   vacyear vacmonth vacage vacdelay vacweek
1:    2020        9      4       -1      39
2:    2019        2      3       -2       7
3:    2020       11      4       -1      44
4:    2019        1      4       -1       1
5:    2018       10      4       -1      42
6:    2020        1      4       -1       3
                                                  type
1: Date of IPV vaccination before schedule (5th month)
2: Date of IPV vaccination before schedule (5th month)
3: Date of IPV vaccination before schedule (5th month)
4: Date of IPV vaccination before schedule (5th month)
5: Date of IPV vaccination before schedule (5th month)
6: Date of IPV vaccination before schedule (5th month)</code></pre>
<pre class="r"><code>#8394/1155541*100 = 0.007%

data_path &lt;- file.path(&quot;..&quot;, &quot;tuann349_vad&quot;)

polio_check &lt;- rbindlist(l = list(polio_check1[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)], 
                            polio_check2[, .(pid, province, district, commune, sex, dob, vacname2, vacdate, vacdelay, type)]))
#fwrite(x = polio_check, file = file.path(data_path, &quot;check_polio.csv&quot;))</code></pre>
<pre class="r"><code>head(polio_check)</code></pre>
<pre><code>               pid province district           commune sex        dob vacname2
1: 101010120190374   Ha Noi  Ba Dinh           Phuc Xa   0 2019-10-05      OPV
2: 101010320180079   Ha Noi  Ba Dinh Nguyen Trung Truc   1 2018-05-02      OPV
3: 101010720180123   Ha Noi  Ba Dinh         Truc Bach   0 2018-09-27      OPV
4: 101011320170377   Ha Noi  Ba Dinh         Lieu Giai   0 2017-08-12      OPV
5: 101011320170377   Ha Noi  Ba Dinh         Lieu Giai   0 2017-08-12      OPV
6: 101011320170377   Ha Noi  Ba Dinh         Lieu Giai   0 2017-08-12      OPV
      vacdate vacdelay                                                type
1: 2019-12-04       -1 Date of OPV vaccination before schedule (2th month)
2: 2018-06-06       -1 Date of OPV vaccination before schedule (2th month)
3: 2018-11-06       -1 Date of OPV vaccination before schedule (2th month)
4: 2017-08-30       -2 Date of OPV vaccination before schedule (2th month)
5: 2017-10-25       -1 Date of OPV vaccination before schedule (2th month)
6: 2017-11-25       -1 Date of OPV vaccination before schedule (2th month)</code></pre>
<pre class="r"><code>polio_check %&gt;% select(-pid, -district, -commune, -type) %&gt;% mutate(sex=factor(sex), vacdelay=factor(vacdelay)) %&gt;% tbl_summary(., by=vacname2)</code></pre>
<pre><code>Column(s) &#39;dob&#39;, and &#39;vacdate&#39; omitted from output.
Accepted classes are &#39;character&#39;, &#39;factor&#39;, &#39;numeric&#39;, &#39;logical&#39;, &#39;integer&#39;, or &#39;difftime&#39;.</code></pre>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xurfwsyxve .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xurfwsyxve .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xurfwsyxve .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xurfwsyxve .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xurfwsyxve .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xurfwsyxve .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xurfwsyxve .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xurfwsyxve .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xurfwsyxve .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xurfwsyxve .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xurfwsyxve .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xurfwsyxve .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xurfwsyxve .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xurfwsyxve .gt_from_md > :first-child {
  margin-top: 0;
}

#xurfwsyxve .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xurfwsyxve .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xurfwsyxve .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#xurfwsyxve .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xurfwsyxve .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#xurfwsyxve .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xurfwsyxve .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xurfwsyxve .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xurfwsyxve .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xurfwsyxve .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xurfwsyxve .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#xurfwsyxve .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xurfwsyxve .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#xurfwsyxve .gt_left {
  text-align: left;
}

#xurfwsyxve .gt_center {
  text-align: center;
}

#xurfwsyxve .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xurfwsyxve .gt_font_normal {
  font-weight: normal;
}

#xurfwsyxve .gt_font_bold {
  font-weight: bold;
}

#xurfwsyxve .gt_font_italic {
  font-style: italic;
}

#xurfwsyxve .gt_super {
  font-size: 65%;
}

#xurfwsyxve .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="xurfwsyxve" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>IPV</strong>, N = 8,394<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>OPV</strong>, N = 54,191<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">province</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Giang</td>
      <td class="gt_row gt_center">370 (4.4%)</td>
      <td class="gt_row gt_center">2,093 (3.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Kan</td>
      <td class="gt_row gt_center">11 (0.1%)</td>
      <td class="gt_row gt_center">133 (0.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Bac Ninh</td>
      <td class="gt_row gt_center">333 (4.0%)</td>
      <td class="gt_row gt_center">1,042 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Cao Bang</td>
      <td class="gt_row gt_center">67 (0.8%)</td>
      <td class="gt_row gt_center">1,364 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Dien Bien</td>
      <td class="gt_row gt_center">641 (7.6%)</td>
      <td class="gt_row gt_center">1,972 (3.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Giang</td>
      <td class="gt_row gt_center">446 (5.3%)</td>
      <td class="gt_row gt_center">4,169 (7.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Nam</td>
      <td class="gt_row gt_center">233 (2.8%)</td>
      <td class="gt_row gt_center">1,010 (1.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Noi</td>
      <td class="gt_row gt_center">328 (3.9%)</td>
      <td class="gt_row gt_center">2,082 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ha Tinh</td>
      <td class="gt_row gt_center">197 (2.3%)</td>
      <td class="gt_row gt_center">1,850 (3.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Duong</td>
      <td class="gt_row gt_center">304 (3.6%)</td>
      <td class="gt_row gt_center">2,358 (4.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hai Phong</td>
      <td class="gt_row gt_center">209 (2.5%)</td>
      <td class="gt_row gt_center">1,365 (2.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hoa Binh</td>
      <td class="gt_row gt_center">152 (1.8%)</td>
      <td class="gt_row gt_center">896 (1.7%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Hung Yen</td>
      <td class="gt_row gt_center">195 (2.3%)</td>
      <td class="gt_row gt_center">1,722 (3.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lai Chau</td>
      <td class="gt_row gt_center">202 (2.4%)</td>
      <td class="gt_row gt_center">2,144 (4.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lang Son</td>
      <td class="gt_row gt_center">90 (1.1%)</td>
      <td class="gt_row gt_center">1,428 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Lao Cai</td>
      <td class="gt_row gt_center">202 (2.4%)</td>
      <td class="gt_row gt_center">1,714 (3.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nam Dinh</td>
      <td class="gt_row gt_center">320 (3.8%)</td>
      <td class="gt_row gt_center">1,570 (2.9%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Nghe An</td>
      <td class="gt_row gt_center">700 (8.3%)</td>
      <td class="gt_row gt_center">6,891 (13%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Ninh Binh</td>
      <td class="gt_row gt_center">95 (1.1%)</td>
      <td class="gt_row gt_center">795 (1.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Phu Tho</td>
      <td class="gt_row gt_center">486 (5.8%)</td>
      <td class="gt_row gt_center">891 (1.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Quang Ninh</td>
      <td class="gt_row gt_center">124 (1.5%)</td>
      <td class="gt_row gt_center">1,289 (2.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Son La</td>
      <td class="gt_row gt_center">514 (6.1%)</td>
      <td class="gt_row gt_center">2,922 (5.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Binh</td>
      <td class="gt_row gt_center">752 (9.0%)</td>
      <td class="gt_row gt_center">2,080 (3.8%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thai Nguyen</td>
      <td class="gt_row gt_center">138 (1.6%)</td>
      <td class="gt_row gt_center">1,107 (2.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Thanh Hoa</td>
      <td class="gt_row gt_center">680 (8.1%)</td>
      <td class="gt_row gt_center">4,892 (9.0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Tuyen Quang</td>
      <td class="gt_row gt_center">103 (1.2%)</td>
      <td class="gt_row gt_center">1,712 (3.2%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Vinh Phuc</td>
      <td class="gt_row gt_center">268 (3.2%)</td>
      <td class="gt_row gt_center">1,304 (2.4%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Yen Bai</td>
      <td class="gt_row gt_center">234 (2.8%)</td>
      <td class="gt_row gt_center">1,396 (2.6%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">sex</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">0</td>
      <td class="gt_row gt_center">4,421 (53%)</td>
      <td class="gt_row gt_center">28,161 (52%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">1</td>
      <td class="gt_row gt_center">3,973 (47%)</td>
      <td class="gt_row gt_center">26,030 (48%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">vacdelay</td>
      <td class="gt_row gt_center"></td>
      <td class="gt_row gt_center"></td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-5</td>
      <td class="gt_row gt_center">66 (0.8%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-4</td>
      <td class="gt_row gt_center">65 (0.8%)</td>
      <td class="gt_row gt_center">0 (0%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-3</td>
      <td class="gt_row gt_center">869 (10%)</td>
      <td class="gt_row gt_center">5 (&lt;0.1%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-2</td>
      <td class="gt_row gt_center">870 (10%)</td>
      <td class="gt_row gt_center">1,904 (3.5%)</td>
    </tr>
    <tr>
      <td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">-1</td>
      <td class="gt_row gt_center">6,524 (78%)</td>
      <td class="gt_row gt_center">52,282 (96%)</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="3">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          n (%)
          <br />
        </p>
      </td>
    </tr>
  </tfoot>
</table></div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=English_United Kingdom.1252 
[2] LC_CTYPE=English_United Kingdom.1252   
[3] LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C                           
[5] LC_TIME=English_United Kingdom.1252    
system code page: 65001

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggridges_0.5.3    gtsummary_1.3.6   gt_0.2.2          lubridate_1.7.9.2
 [5] forcats_0.5.1     stringr_1.4.0     dplyr_1.0.3       purrr_0.3.4      
 [9] readr_1.4.0       tidyr_1.1.2       tibble_3.0.5      ggplot2_3.3.3    
[13] tidyverse_1.3.0   data.table_1.13.6

loaded via a namespace (and not attached):
 [1] httr_1.4.2          sass_0.3.1          jsonlite_1.7.2     
 [4] splines_4.0.3       modelr_0.1.8        assertthat_0.2.1   
 [7] highr_0.8           cellranger_1.1.0    yaml_2.2.1         
[10] pillar_1.4.7        backports_1.2.0     lattice_0.20-41    
[13] glue_1.4.2          digest_0.6.27       promises_1.1.1     
[16] checkmate_2.0.0     rvest_0.3.6         colorspace_2.0-0   
[19] htmltools_0.5.1.1   httpuv_1.5.5        Matrix_1.2-18      
[22] plyr_1.8.6          pkgconfig_2.0.3     broom_0.7.4        
[25] haven_2.3.1         scales_1.1.1        whisker_0.4        
[28] later_1.1.0.1       git2r_0.28.0        mgcv_1.8-33        
[31] generics_0.1.0      farver_2.0.3        usethis_2.0.0      
[34] ellipsis_0.3.1      withr_2.4.1         cli_2.2.0          
[37] survival_3.2-7      magrittr_2.0.1      crayon_1.4.0       
[40] readxl_1.3.1        evaluate_0.14       fs_1.5.0           
[43] fansi_0.4.1         broom.helpers_1.1.0 nlme_3.1-151       
[46] xml2_1.3.2          tools_4.0.3         hms_1.0.0          
[49] lifecycle_0.2.0     munsell_0.5.0       reprex_1.0.0       
[52] compiler_4.0.3      rlang_0.4.10        grid_4.0.3         
[55] rstudioapi_0.13     labeling_0.4.2      rmarkdown_2.6      
[58] gtable_0.3.0        DBI_1.1.1           R6_2.5.0           
[61] knitr_1.31          commonmark_1.7      workflowr_1.6.2    
[64] rprojroot_2.0.2     stringi_1.5.3       Rcpp_1.0.6         
[67] vctrs_0.3.6         dbplyr_2.0.0        tidyselect_1.1.0   
[70] xfun_0.20          </code></pre>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
